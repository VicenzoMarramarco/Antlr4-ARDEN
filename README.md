# Arden DSL (course project)

This workspace contains a small ANTLR4-based DSL called `Arden` (simplified) and a visitor-based executor implemented in Python.

Files added/modified:
- `Arden.g4` - original grammar (in workspace)
- `ArdenParser.py`, `ArdenLexer.py` - generated by ANTLR (in workspace)
- `ArdenVisitor.py` - minimal visitor base
- `main.py` - visitor executor and runner (`ArdenExecutor`)
- `Arden_augmented.g4` - annotated grammar showing semantic action locations
- `exemplo1.mlm`, `exemplo2.mlm`, `exemplo3.mlm` - three example inputs for the assignment

**Running**
- Requires `antlr4-python3-runtime` installed in your Python environment.

Install (global or inside virtualenv):
```powershell
pip install antlr4-python3-runtime
```

Recommended: use the project's virtual environment. Two safe ways to run:

- Temporarily allow script execution in the current PowerShell session and activate the venv (safer, only for this session):
```powershell
Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process -Force
.\.venv\Scripts\Activate.ps1
python main.py exemplo1.mlm
```

- If you prefer not to change execution policy, call the venv Python executable directly (no activation required):
```powershell
C:/Users/vicen/Desktop/antlr4-ARDEN/.venv/Scripts/python.exe main.py exemplo1.mlm
C:/Users/vicen/Desktop/antlr4-ARDEN/.venv/Scripts/python.exe main.py exemplo2.mlm
C:/Users/vicen/Desktop/antlr4-ARDEN/.venv/Scripts/python.exe main.py exemplo3.mlm
```

Run all examples in one line (PowerShell):
```powershell
C:/Users/vicen/Desktop/antlr4-ARDEN/.venv/Scripts/python.exe .\main.py .\exemplo1.mlm
C:/Users/vicen/Desktop/antlr4-ARDEN/.venv/Scripts/python.exe .\main.py .\exemplo2.mlm
C:/Users/vicen/Desktop/antlr4-ARDEN/.venv/Scripts/python.exe .\main.py .\exemplo3.mlm
C:/Users/vicen/Desktop/antlr4-ARDEN/.venv/Scripts/python.exe .\main.py .\exemplo4.mlm
```

- Or on Windows `cmd.exe` you can activate with `activate.bat`:
```cmd
.\.venv\Scripts\activate.bat
python main.py exemplo1.mlm
```

Where results appear
- All output from the executor is printed to standard output (the terminal / console). The executor prints a short header and then any actions executed. Example output for the provided examples:



Why only the header may appear
- The executor prints a header immediately; further lines (logic evaluation and actions) depend on how the visitor evaluates the parsed tree and the variable values available at runtime. If you see only the header, try one of the following to get full action output:
	- Verify the example file is in the current working directory and matches the grammar (it is in this repo).
	- Change variables used by the logic (in `main.py` `ArdenExecutor.__init__`) to values that make conditions true (for example set `glucose` to 300).
	- Add debug prints inside `main.py` (e.g., in `visitDataBlock` / `visitLogicBlock`) to trace evaluation.

Notes
- If you see `ModuleNotFoundError: No module named 'antlr4'`, install the runtime (see above) or run via the venv Python executable.
- To check PowerShell execution policies:
```powershell
Get-ExecutionPolicy -List
```

What to present in the video
---------------------------
- Team members' names and roles
- Reference to the parser (`Arden.g4`) and ANTLR version used
- Demonstration: run the three example inputs and show outputs
- Show `Arden_augmented.g4` and point where semantic actions are executed
- Explain the domain: simple clinical alerts (glucose/age)
- Show how to run and how to install runtime

Notes
-----
This is a compact project scaffold for the assignment. The `ArdenExecutor` in `main.py` implements visitor-based semantics rather than embedding target-language actions inside the grammar, which keeps the grammar clean and portable.

Requisitos do Trabalho (Checklist)
---------------------------------
- EDSL com ANTLR4: linguagem externa com gramática `Arden.g4` e artefatos gerados (`ArdenLexer.py`, `ArdenParser.py`).
- Execução/semântica: implementada via visitante `ArdenExecutor` em `main.py` (interpreta a AST e executa ações).
- Saída/execução: o parser + executor "executa" textos na DSL e imprime efeitos em console.
- Três textos válidos: `exemplo1.mlm`, `exemplo2.mlm`, `exemplo3.mlm` fornecidos e demonstráveis.
- Gramática aumentada: `Arden_augmented.g4` anota onde ações semânticas são aplicadas e referencia o visitante.
- Ação adicional: logging semântico por regra (And/Or/Not, AddSub/MulDiv, Comparison/Equality, Parens e resolução de IDs) para demonstrar regras acionadas.
- Domínio: suporte à decisão clínica simples (ex.: alerta por glicose elevada, notificar responsável, recomendar exames) visando profissionais de saúde não-programadores.

Demonstração (Saídas Resumidas)
-------------------------------
Executado com Python da venv (sem ativar):

```powershell
& C:/Users/vicen/Desktop/antlr/.venv/Scripts/python.exe .\main.py .\exemplo1.mlm
& C:/Users/vicen/Desktop/antlr/.venv/Scripts/python.exe .\main.py .\exemplo2.mlm
& C:/Users/vicen/Desktop/antlr/.venv/Scripts/python.exe .\main.py .\exemplo3.mlm
```

Saídas obtidas nos testes locais:
- exemplo1.mlm
	- DataBlock registra: glucose=250, age=45 (padrões)
	- Logic: `glucose > 200` -> True
	- Action: `alert` -> imprime "ACTION: ALERT — glucose=250"
- exemplo2.mlm
	- Logic: `age < 18` -> False com age=45
	- Resultado: "No action executed: logic conditions evaluated to False"
- exemplo3.mlm
	- Logic: `glucose + age > 250 && glucose < 300` -> True
	- Actions: `recommend_test` e `alert` executadas
- exemplo4.mlm (ação adicional)
	- Logic: `glucose > 100` -> True
	- Actions: `log_metrics` (nova ação) e `alert` executadas

Como as regras são demonstradas
-------------------------------
- O visitante imprime logs detalhados das regras de avaliação em `main.py`:
	- Resolução de IDs (ex.: `Expr: ID 'glucose' -> 250`)
	- Operadores: `Rule AddSub`, `Rule MulDiv`, `Rule Comparison`, `Rule Equality`, `Rule And`, `Rule Or`, `Rule Not`, `Rule Parens`.
	- Avaliação do bloco de lógica: lista de resultados e o "any" final.

Nota sobre ação adicional na gramática
--------------------------------------
- O arquivo `Arden_augmented.g4` inclui um exemplo de ação embutida comentada na alternativa `AddSub`, apenas para ilustração da estratégia de tradução dirigida por sintaxe.
- A execução real usa a abordagem Visitor (mais portátil). Mantemos a ação comentada para não quebrar a geração com outros targets.

Domínio e tarefa para leigos
----------------------------
- Domínio: suporte à decisão clínica simplificado.
- Tarefas: escrever regras legíveis como "logic: glucose > 200; action: alert;" que disparam alertas/recomendações.
- Benefício: profissionais de saúde não precisam programar em Python; escrevem regras declarativas em DSL.

Referências e apresentação
--------------------------
- Ferramenta: ANTLR4 (runtime Python: `antlr4-python3-runtime`).
- Código aberto: este repositório/workspace contém todos os artefatos necessários.
- Vídeo: apresentar time, parser/gramática, execução dos 3 exemplos, pontos de ação semântica em `Arden_augmented.g4`, e instruções de ambiente (incluindo ExecutionPolicy no PowerShell se aplicável).
